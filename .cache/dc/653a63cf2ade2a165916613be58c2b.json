{"id":"fvJN","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585391671622},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":5,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"safer-buffer","loc":{"line":6,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"./algs","loc":{"line":7,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/algs.js"},{"name":"crypto","loc":{"line":8,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/.config/yarn/global/node_modules/crypto-browserify/index.js"},{"name":"./fingerprint","loc":{"line":9,"column":26},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/fingerprint.js"},{"name":"./signature","loc":{"line":10,"column":24},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js"},{"name":"./errors","loc":{"line":11,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/errors.js"},{"name":"util","loc":{"line":12,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/.config/yarn/global/node_modules/util/util.js"},{"name":"./utils","loc":{"line":13,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"./key","loc":{"line":14,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/key.js"},{"name":"./private-key","loc":{"line":15,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/private-key.js"},{"name":"./identity","loc":{"line":16,"column":23},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/identity.js"},{"name":"./formats/openssh-cert","loc":{"line":19,"column":29},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js"},{"name":"./formats/x509","loc":{"line":20,"column":26},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/x509.js"},{"name":"./formats/x509-pem","loc":{"line":21,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/x509-pem.js"}],"generated":{"js":"\nmodule.exports=m;var e=require(\"assert-plus\"),t=require(\"safer-buffer\").Buffer,i=require(\"./algs\"),r=require(\"crypto\"),s=require(\"./fingerprint\"),o=require(\"./signature\"),n=require(\"./errors\"),a=require(\"util\"),u=require(\"./utils\"),p=require(\"./key\"),l=require(\"./private-key\"),f=require(\"./identity\"),h={};h.openssh=require(\"./formats/openssh-cert\"),h.x509=require(\"./formats/x509\"),h.pem=require(\"./formats/x509-pem\");var c=n.CertificateParseError,d=n.InvalidAlgorithmError;function m(t){e.object(t,\"options\"),e.arrayOfObject(t.subjects,\"options.subjects\"),u.assertCompatible(t.subjects[0],f,[1,0],\"options.subjects\"),u.assertCompatible(t.subjectKey,p,[1,0],\"options.subjectKey\"),u.assertCompatible(t.issuer,f,[1,0],\"options.issuer\"),void 0!==t.issuerKey&&u.assertCompatible(t.issuerKey,p,[1,0],\"options.issuerKey\"),e.object(t.signatures,\"options.signatures\"),e.buffer(t.serial,\"options.serial\"),e.date(t.validFrom,\"options.validFrom\"),e.date(t.validUntil,\"optons.validUntil\"),e.optionalArrayOfString(t.purposes,\"options.purposes\"),this._hashCache={},this.subjects=t.subjects,this.issuer=t.issuer,this.subjectKey=t.subjectKey,this.issuerKey=t.issuerKey,this.signatures=t.signatures,this.serial=t.serial,this.validFrom=t.validFrom,this.validUntil=t.validUntil,this.purposes=t.purposes}m.formats=h,m.prototype.toBuffer=function(t,i){return void 0===t&&(t=\"x509\"),e.string(t,\"format\"),e.object(h[t],\"formats[format]\"),e.optionalObject(i,\"options\"),h[t].write(this,i)},m.prototype.toString=function(e,t){return void 0===e&&(e=\"pem\"),this.toBuffer(e,t).toString()},m.prototype.fingerprint=function(t){void 0===t&&(t=\"sha256\"),e.string(t,\"algorithm\");var i={type:\"certificate\",hash:this.hash(t),algorithm:t};return new s(i)},m.prototype.hash=function(t){if(e.string(t,\"algorithm\"),t=t.toLowerCase(),void 0===i.hashAlgs[t])throw new d(t);if(this._hashCache[t])return this._hashCache[t];var s=r.createHash(t).update(this.toBuffer(\"x509\")).digest();return this._hashCache[t]=s,s},m.prototype.isExpired=function(e){return void 0===e&&(e=new Date),!(e.getTime()>=this.validFrom.getTime()&&e.getTime()<this.validUntil.getTime())},m.prototype.isSignedBy=function(e){return u.assertCompatible(e,m,[1,0],\"issuer\"),!!this.issuer.equals(e.subjects[0])&&(!(this.issuer.purposes&&this.issuer.purposes.length>0&&-1===this.issuer.purposes.indexOf(\"ca\"))&&this.isSignedByKey(e.subjectKey))},m.prototype.getExtension=function(t){return e.string(t,\"keyOrOid\"),this.getExtensions().filter(function(e){return\"x509\"===e.format?e.oid===t:\"openssh\"===e.format&&e.name===t})[0]},m.prototype.getExtensions=function(){var e=[],t=this.signatures.x509;t&&t.extras&&t.extras.exts&&t.extras.exts.forEach(function(t){t.format=\"x509\",e.push(t)});var i=this.signatures.openssh;return i&&i.exts&&i.exts.forEach(function(t){t.format=\"openssh\",e.push(t)}),e},m.prototype.isSignedByKey=function(e){if(u.assertCompatible(e,p,[1,2],\"issuerKey\"),void 0!==this.issuerKey)return this.issuerKey.fingerprint(\"sha512\").matches(e);var t=Object.keys(this.signatures)[0],i=h[t].verify(this,e);return i&&(this.issuerKey=e),i},m.prototype.signWith=function(e){u.assertCompatible(e,l,[1,2],\"key\");for(var t=Object.keys(h),i=!1,r=0;r<t.length;++r){if(\"pem\"!==t[r])!0===h[t[r]].sign(this,e)&&(i=!0)}if(!i)throw new Error(\"Failed to sign the certificate for any available certificate formats\")},m.createSelfSigned=function(i,r,s){var o;o=Array.isArray(i)?i:[i],e.arrayOfObject(o),o.forEach(function(e){u.assertCompatible(e,f,[1,0],\"subject\")}),u.assertCompatible(r,l,[1,2],\"private key\"),e.optionalObject(s,\"options\"),void 0===s&&(s={}),e.optionalObject(s.validFrom,\"options.validFrom\"),e.optionalObject(s.validUntil,\"options.validUntil\");var n=s.validFrom,a=s.validUntil;if(void 0===n&&(n=new Date),void 0===a){e.optionalNumber(s.lifetime,\"options.lifetime\");var p=s.lifetime;void 0===p&&(p=31536e4),(a=new Date).setTime(a.getTime()+1e3*p)}e.optionalBuffer(s.serial,\"options.serial\");var h=s.serial;void 0===h&&(h=t.from(\"0000000000000001\",\"hex\"));var c=s.purposes;if(void 0===c&&(c=[]),-1===c.indexOf(\"signature\")&&c.push(\"signature\"),-1===c.indexOf(\"ca\")&&c.push(\"ca\"),-1===c.indexOf(\"crl\")&&c.push(\"crl\"),c.length<=3){var d=o.filter(function(e){return\"host\"===e.type}),v=o.filter(function(e){return\"user\"===e.type});d.length>0&&-1===c.indexOf(\"serverAuth\")&&c.push(\"serverAuth\"),v.length>0&&-1===c.indexOf(\"clientAuth\")&&c.push(\"clientAuth\"),(v.length>0||d.length>0)&&(-1===c.indexOf(\"keyAgreement\")&&c.push(\"keyAgreement\"),\"rsa\"===r.type&&-1===c.indexOf(\"encryption\")&&c.push(\"encryption\"))}var y=new m({subjects:o,issuer:o[0],subjectKey:r.toPublic(),issuerKey:r.toPublic(),signatures:{},serial:h,validFrom:n,validUntil:a,purposes:c});return y.signWith(r),y},m.create=function(i,r,s,o,n){var a;a=Array.isArray(i)?i:[i],e.arrayOfObject(a),a.forEach(function(e){u.assertCompatible(e,f,[1,0],\"subject\")}),u.assertCompatible(r,p,[1,0],\"key\"),l.isPrivateKey(r)&&(r=r.toPublic()),u.assertCompatible(s,f,[1,0],\"issuer\"),u.assertCompatible(o,l,[1,2],\"issuer key\"),e.optionalObject(n,\"options\"),void 0===n&&(n={}),e.optionalObject(n.validFrom,\"options.validFrom\"),e.optionalObject(n.validUntil,\"options.validUntil\");var h=n.validFrom,c=n.validUntil;if(void 0===h&&(h=new Date),void 0===c){e.optionalNumber(n.lifetime,\"options.lifetime\");var d=n.lifetime;void 0===d&&(d=31536e4),(c=new Date).setTime(c.getTime()+1e3*d)}e.optionalBuffer(n.serial,\"options.serial\");var v=n.serial;void 0===v&&(v=t.from(\"0000000000000001\",\"hex\"));var y=n.purposes;void 0===y&&(y=[]),-1===y.indexOf(\"signature\")&&y.push(\"signature\"),!0===n.ca&&(-1===y.indexOf(\"ca\")&&y.push(\"ca\"),-1===y.indexOf(\"crl\")&&y.push(\"crl\"));var g=a.filter(function(e){return\"host\"===e.type}),b=a.filter(function(e){return\"user\"===e.type});g.length>0&&-1===y.indexOf(\"serverAuth\")&&y.push(\"serverAuth\"),b.length>0&&-1===y.indexOf(\"clientAuth\")&&y.push(\"clientAuth\"),(b.length>0||g.length>0)&&(-1===y.indexOf(\"keyAgreement\")&&y.push(\"keyAgreement\"),\"rsa\"===r.type&&-1===y.indexOf(\"encryption\")&&y.push(\"encryption\"));var x=new m({subjects:a,issuer:s,subjectKey:r,issuerKey:o.toPublic(),signatures:{},serial:v,validFrom:h,validUntil:c,purposes:y});return x.signWith(o),x},m.parse=function(t,i,r){\"string\"!=typeof t&&e.buffer(t,\"data\"),void 0===i&&(i=\"auto\"),e.string(i,\"format\"),\"string\"==typeof r&&(r={filename:r}),e.optionalObject(r,\"options\"),void 0===r&&(r={}),e.optionalString(r.filename,\"options.filename\"),void 0===r.filename&&(r.filename=\"(unnamed)\"),e.object(h[i],\"formats[format]\");try{return h[i].read(t,r)}catch(s){throw new c(r.filename,i,s)}},m.isCertificate=function(e,t){return u.isCompatible(e,m,t)},m.prototype._sshpkApiVersion=[1,1],m._oldVersionDetect=function(e){return[1,0]};"},"sourceMaps":null,"error":null,"hash":"5a1ff321c5c908ca62ca4ea0e794059d","cacheData":{"env":{}}}