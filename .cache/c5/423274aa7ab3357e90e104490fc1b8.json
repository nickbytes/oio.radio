{"id":"vcMt","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585257763511},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":14,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"asn1","loc":{"line":15,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/asn1/lib/index.js"},{"name":"safer-buffer","loc":{"line":16,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"../algs","loc":{"line":17,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/algs.js"},{"name":"../utils","loc":{"line":18,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"../key","loc":{"line":19,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/key.js"},{"name":"../private-key","loc":{"line":20,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/private-key.js"},{"name":"./pem","loc":{"line":21,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js"}],"generated":{"js":"\nmodule.exports={read:d,readPkcs8:B,write:f,writePkcs8:O,pkcs8ToBuffer:y,readECDSACurve:q,writeECDSACurve:D};var e=require(\"assert-plus\"),r=require(\"asn1\"),t=require(\"safer-buffer\").Buffer,a=require(\"../algs\"),n=require(\"../utils\"),i=require(\"../key\"),u=require(\"../private-key\"),c=require(\"./pem\");function d(e,r){return c.read(e,r,\"pkcs8\")}function f(e,r){return c.write(e,r,\"pkcs8\")}function o(t,a){return e.strictEqual(t.peek(),r.Ber.Integer,a+\" is not an Integer\"),n.mpNormalize(t.readString(r.Ber.Integer,!0))}function B(t,a,n){n.peek()===r.Ber.Integer&&(e.strictEqual(a,\"private\",\"unexpected Integer at start of public key\"),n.readString(r.Ber.Integer,!0)),n.readSequence();var i=n.offset+n.length,u=n.readOID();switch(u){case\"1.2.840.113549.1.1.1\":return n._offset=i,\"public\"===a?p(n):S(n);case\"1.2.840.10040.4.1\":return\"public\"===a?s(n):g(n);case\"1.2.840.10045.2.1\":return\"public\"===a?m(n):v(n);case\"1.3.101.112\":return\"public\"===a?w(n):k(n);case\"1.3.101.110\":return\"public\"===a?l(n):I(n);default:throw new Error(\"Unknown key type OID \"+u)}}function p(e){e.readSequence(r.Ber.BitString),e.readByte(),e.readSequence();var t=o(e,\"modulus\"),a=o(e,\"exponent\"),n={type:\"rsa\",source:e.originalInput,parts:[{name:\"e\",data:a},{name:\"n\",data:t}]};return new i(n)}function S(t){t.readSequence(r.Ber.OctetString),t.readSequence();var a=o(t,\"version\");e.equal(a[0],0,\"unknown RSA private key version\");var n=o(t,\"modulus\"),i=o(t,\"public exponent\"),c=o(t,\"private exponent\"),d=o(t,\"prime1\"),f=o(t,\"prime2\"),B=o(t,\"exponent1\"),p=o(t,\"exponent2\"),S=o(t,\"iqmp\");return new u({type:\"rsa\",parts:[{name:\"n\",data:n},{name:\"e\",data:i},{name:\"d\",data:c},{name:\"iqmp\",data:S},{name:\"p\",data:d},{name:\"q\",data:f},{name:\"dmodp\",data:B},{name:\"dmodq\",data:p}]})}function s(e){e.readSequence();var t=o(e,\"p\"),a=o(e,\"q\"),n=o(e,\"g\");e.readSequence(r.Ber.BitString),e.readByte();var u=o(e,\"y\");return new i({type:\"dsa\",parts:[{name:\"p\",data:t},{name:\"q\",data:a},{name:\"g\",data:n},{name:\"y\",data:u}]})}function g(e){e.readSequence();var t=o(e,\"p\"),a=o(e,\"q\"),i=o(e,\"g\");e.readSequence(r.Ber.OctetString);var c=o(e,\"x\"),d=n.calculateDSAPublic(i,t,c);return new u({type:\"dsa\",parts:[{name:\"p\",data:t},{name:\"q\",data:a},{name:\"g\",data:i},{name:\"y\",data:d},{name:\"x\",data:c}]})}function q(i){var u,c,d,f,o;if(i.peek()===r.Ber.OID){var B=i.readOID();for(c=Object.keys(a.curves),d=0;d<c.length;++d)if(f=c[d],(o=a.curves[f]).pkcs8oid===B){u=f;break}}else{i.readSequence();var p=i.readString(r.Ber.Integer,!0);e.strictEqual(p[0],1,\"ECDSA key not version 1\");var S={};i.readSequence();var s=i.readOID();e.strictEqual(s,\"1.2.840.10045.1.1\",\"ECDSA key is not from a prime-field\");var g=S.p=n.mpNormalize(i.readString(r.Ber.Integer,!0));S.size=8*g.length-n.countZeros(g),i.readSequence(),S.a=n.mpNormalize(i.readString(r.Ber.OctetString,!0)),S.b=n.mpNormalize(i.readString(r.Ber.OctetString,!0)),i.peek()===r.Ber.BitString&&(S.s=i.readString(r.Ber.BitString,!0)),S.G=i.readString(r.Ber.OctetString,!0),e.strictEqual(S.G[0],4,\"uncompressed G is required\"),S.n=n.mpNormalize(i.readString(r.Ber.Integer,!0)),S.h=n.mpNormalize(i.readString(r.Ber.Integer,!0)),e.strictEqual(S.h[0],1,\"a cofactor=1 curve is required\"),c=Object.keys(a.curves);var q=Object.keys(S);for(d=0;d<c.length;++d){f=c[d],o=a.curves[f];for(var v=!0,m=0;m<q.length;++m){var w=q[m];if(void 0!==o[w])if(\"object\"==typeof o[w]&&void 0!==o[w].equals){if(!o[w].equals(S[w])){v=!1;break}}else if(t.isBuffer(o[w])){if(o[w].toString(\"binary\")!==S[w].toString(\"binary\")){v=!1;break}}else if(o[w]!==S[w]){v=!1;break}}if(v){u=f;break}}}return u}function v(a){var i=q(a);e.string(i,\"a known elliptic curve\"),a.readSequence(r.Ber.OctetString),a.readSequence();var c=o(a,\"version\");e.equal(c[0],1,\"unknown version of ECDSA key\");var d,f=a.readString(r.Ber.OctetString,!0);(160==a.peek()&&(a.readSequence(160),a._offset+=a.length),161==a.peek()&&(a.readSequence(161),d=a.readString(r.Ber.BitString,!0),d=n.ecNormalize(d)),void 0===d)&&(d=n.publicFromPrivateECDSA(i,f).part.Q.data);var B={type:\"ecdsa\",parts:[{name:\"curve\",data:t.from(i)},{name:\"Q\",data:d},{name:\"d\",data:f}]};return new u(B)}function m(a){var u=q(a);e.string(u,\"a known elliptic curve\");var c=a.readString(r.Ber.BitString,!0);c=n.ecNormalize(c);var d={type:\"ecdsa\",parts:[{name:\"curve\",data:t.from(u)},{name:\"Q\",data:c}]};return new i(d)}function w(e){0===e.peek()&&e.readByte();var r=n.readBitString(e),t={type:\"ed25519\",parts:[{name:\"A\",data:n.zeroPadToLength(r,32)}]};return new i(t)}function l(e){var r=n.readBitString(e),t={type:\"curve25519\",parts:[{name:\"A\",data:n.zeroPadToLength(r,32)}]};return new i(t)}function k(e){0===e.peek()&&e.readByte(),e.readSequence(r.Ber.OctetString);var t,a=e.readString(r.Ber.OctetString,!0);a=n.zeroPadToLength(a,32),e.peek()===r.Ber.BitString?(t=n.readBitString(e),t=n.zeroPadToLength(t,32)):t=n.calculateED25519Public(a);var i={type:\"ed25519\",parts:[{name:\"A\",data:n.zeroPadToLength(t,32)},{name:\"k\",data:n.zeroPadToLength(a,32)}]};return new u(i)}function I(e){0===e.peek()&&e.readByte(),e.readSequence(r.Ber.OctetString);var t=e.readString(r.Ber.OctetString,!0);t=n.zeroPadToLength(t,32);var a=n.calculateX25519Public(t),i={type:\"curve25519\",parts:[{name:\"A\",data:n.zeroPadToLength(a,32)},{name:\"k\",data:n.zeroPadToLength(t,32)}]};return new u(i)}function y(e){var t=new r.BerWriter;return O(t,e),t.buffer}function O(e,a){if(e.startSequence(),u.isPrivateKey(a)){var n=t.from([0]);e.writeBuffer(n,r.Ber.Integer)}switch(e.startSequence(),a.type){case\"rsa\":e.writeOID(\"1.2.840.113549.1.1.1\"),u.isPrivateKey(a)?b(a,e):h(a,e);break;case\"dsa\":e.writeOID(\"1.2.840.10040.4.1\"),u.isPrivateKey(a)?z(a,e):P(a,e);break;case\"ecdsa\":e.writeOID(\"1.2.840.10045.2.1\"),u.isPrivateKey(a)?A(a,e):E(a,e);break;case\"ed25519\":if(e.writeOID(\"1.3.101.112\"),u.isPrivateKey(a))throw new Error(\"Ed25519 private keys in pkcs8 format are not supported\");N(a,e);break;default:throw new Error(\"Unsupported key type: \"+a.type)}e.endSequence()}function b(e,a){a.writeNull(),a.endSequence(),a.startSequence(r.Ber.OctetString),a.startSequence();var i=t.from([0]);a.writeBuffer(i,r.Ber.Integer),a.writeBuffer(e.part.n.data,r.Ber.Integer),a.writeBuffer(e.part.e.data,r.Ber.Integer),a.writeBuffer(e.part.d.data,r.Ber.Integer),a.writeBuffer(e.part.p.data,r.Ber.Integer),a.writeBuffer(e.part.q.data,r.Ber.Integer),e.part.dmodp&&e.part.dmodq||n.addRSAMissing(e),a.writeBuffer(e.part.dmodp.data,r.Ber.Integer),a.writeBuffer(e.part.dmodq.data,r.Ber.Integer),a.writeBuffer(e.part.iqmp.data,r.Ber.Integer),a.endSequence(),a.endSequence()}function h(e,t){t.writeNull(),t.endSequence(),t.startSequence(r.Ber.BitString),t.writeByte(0),t.startSequence(),t.writeBuffer(e.part.n.data,r.Ber.Integer),t.writeBuffer(e.part.e.data,r.Ber.Integer),t.endSequence(),t.endSequence()}function z(e,t){t.startSequence(),t.writeBuffer(e.part.p.data,r.Ber.Integer),t.writeBuffer(e.part.q.data,r.Ber.Integer),t.writeBuffer(e.part.g.data,r.Ber.Integer),t.endSequence(),t.endSequence(),t.startSequence(r.Ber.OctetString),t.writeBuffer(e.part.x.data,r.Ber.Integer),t.endSequence()}function P(e,t){t.startSequence(),t.writeBuffer(e.part.p.data,r.Ber.Integer),t.writeBuffer(e.part.q.data,r.Ber.Integer),t.writeBuffer(e.part.g.data,r.Ber.Integer),t.endSequence(),t.endSequence(),t.startSequence(r.Ber.BitString),t.writeByte(0),t.writeBuffer(e.part.y.data,r.Ber.Integer),t.endSequence()}function D(e,n){var i=a.curves[e.curve];if(i.pkcs8oid)n.writeOID(i.pkcs8oid);else{n.startSequence();var u=t.from([1]);n.writeBuffer(u,r.Ber.Integer),n.startSequence(),n.writeOID(\"1.2.840.10045.1.1\"),n.writeBuffer(i.p,r.Ber.Integer),n.endSequence(),n.startSequence();var c=i.p;0===c[0]&&(c=c.slice(1)),n.writeBuffer(c,r.Ber.OctetString),n.writeBuffer(i.b,r.Ber.OctetString),n.writeBuffer(i.s,r.Ber.BitString),n.endSequence(),n.writeBuffer(i.G,r.Ber.OctetString),n.writeBuffer(i.n,r.Ber.Integer);var d=i.h;d||(d=t.from([1])),n.writeBuffer(d,r.Ber.Integer),n.endSequence()}}function E(e,t){D(e,t),t.endSequence();var a=n.ecNormalize(e.part.Q.data,!0);t.writeBuffer(a,r.Ber.BitString)}function A(e,a){D(e,a),a.endSequence(),a.startSequence(r.Ber.OctetString),a.startSequence();var i=t.from([1]);a.writeBuffer(i,r.Ber.Integer),a.writeBuffer(e.part.d.data,r.Ber.OctetString),a.startSequence(161);var u=n.ecNormalize(e.part.Q.data,!0);a.writeBuffer(u,r.Ber.BitString),a.endSequence(),a.endSequence(),a.endSequence()}function N(e,r){r.endSequence(),n.writeBitString(r,e.part.A.data)}function x(e,t){t.endSequence();var a=n.mpNormalize(e.part.k.data,!0);t.startSequence(r.Ber.OctetString),t.writeBuffer(a,r.Ber.OctetString),t.endSequence()}"},"sourceMaps":null,"error":null,"hash":"2d6d8d21c220a67d99b5e646917bcfd4","cacheData":{"env":{}}}