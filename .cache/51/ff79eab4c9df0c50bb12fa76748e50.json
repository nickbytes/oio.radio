{"id":"VBdO","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585257763511},{"name":"/Users/m/.config/yarn/global/node_modules/browserify-sign/package.json","includedInParent":true,"mtime":1578331558333},{"name":"bn.js","loc":{"line":2,"column":17},"parent":"/Users/m/.config/yarn/global/node_modules/browserify-sign/browser/verify.js","resolved":"/Users/m/.config/yarn/global/node_modules/bn.js/lib/bn.js"},{"name":"elliptic","loc":{"line":3,"column":17},"parent":"/Users/m/.config/yarn/global/node_modules/browserify-sign/browser/verify.js","resolved":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic.js"},{"name":"parse-asn1","loc":{"line":4,"column":24},"parent":"/Users/m/.config/yarn/global/node_modules/browserify-sign/browser/verify.js","resolved":"/Users/m/.config/yarn/global/node_modules/parse-asn1/index.js"},{"name":"./curves.json","loc":{"line":5,"column":21},"parent":"/Users/m/.config/yarn/global/node_modules/browserify-sign/browser/verify.js","resolved":"/Users/m/.config/yarn/global/node_modules/browserify-sign/browser/curves.json"},{"name":"buffer","parent":"/Users/m/.config/yarn/global/node_modules/browserify-sign/browser/verify.js","resolved":"/Users/m/.config/yarn/global/node_modules/buffer/index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar r=require(\"buffer\").Buffer,e=require(\"bn.js\"),n=require(\"elliptic\").ec,t=require(\"parse-asn1\"),o=require(\"./curves.json\");function a(n,o,a,d,c){var w=t(a);if(\"ec\"===w.type){if(\"ecdsa\"!==d&&\"ecdsa/rsa\"!==d)throw new Error(\"wrong public key type\");return u(n,o,w)}if(\"dsa\"===w.type){if(\"dsa\"!==d)throw new Error(\"wrong public key type\");return i(n,o,w)}if(\"rsa\"!==d&&\"ecdsa/rsa\"!==d)throw new Error(\"wrong public key type\");o=r.concat([c,o]);for(var s=w.modulus.byteLength(),f=[1],l=0;o.length+f.length+2<s;)f.push(255),l++;f.push(0);for(var m=-1;++m<o.length;)f.push(o[m]);f=new r(f);var p=e.mont(w.modulus);n=(n=new e(n).toRed(p)).redPow(new e(w.publicExponent)),n=new r(n.fromRed().toArray());var h=l<8?1:0;for(s=Math.min(n.length,f.length),n.length!==f.length&&(h=1),m=-1;++m<s;)h|=n[m]^f[m];return 0===h}function u(r,e,t){var a=o[t.data.algorithm.curve.join(\".\")];if(!a)throw new Error(\"unknown curve \"+t.data.algorithm.curve.join(\".\"));var u=new n(a),i=t.data.subjectPrivateKey.data;return u.verify(e,r,i)}function i(r,n,o){var a=o.data.p,u=o.data.q,i=o.data.g,c=o.data.pub_key,w=t.signature.decode(r,\"der\"),s=w.s,f=w.r;d(s,u),d(f,u);var l=e.mont(a),m=s.invm(u);return 0===i.toRed(l).redPow(new e(n).mul(m).mod(u)).fromRed().mul(c.toRed(l).redPow(f.mul(m).mod(u)).fromRed()).mod(a).mod(u).cmp(f)}function d(r,e){if(r.cmpn(0)<=0)throw new Error(\"invalid sig\");if(r.cmp(e)>=e)throw new Error(\"invalid sig\")}module.exports=a;"},"sourceMaps":null,"error":null,"hash":"b6dc00a7fc29ea2230994dff8301b4e1","cacheData":{"env":{}}}