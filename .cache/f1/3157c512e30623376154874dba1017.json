{"id":"XEz4","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585257763511},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":8,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/dnssec.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"safer-buffer","loc":{"line":9,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/dnssec.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"../key","loc":{"line":10,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/dnssec.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/key.js"},{"name":"../private-key","loc":{"line":11,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/dnssec.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/private-key.js"},{"name":"../utils","loc":{"line":12,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/dnssec.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"../ssh-buffer","loc":{"line":13,"column":24},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/dnssec.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/ssh-buffer.js"},{"name":"../dhe","loc":{"line":14,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/dnssec.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js"}],"generated":{"js":"\nmodule.exports={read:m,write:A};var r=require(\"assert-plus\"),e=require(\"safer-buffer\").Buffer,a=require(\"../key\"),t=require(\"../private-key\"),n=require(\"../utils\"),i=require(\"../ssh-buffer\"),o=require(\"../dhe\"),p={\"rsa-sha1\":5,\"rsa-sha256\":8,\"rsa-sha512\":10,\"ecdsa-p256-sha256\":13,\"ecdsa-p384-sha384\":14},s={};function m(e,a){\"string\"!=typeof e&&(r.buffer(e,\"buf\"),e=e.toString(\"ascii\"));var t=e.split(\"\\n\");if(t[0].match(/^Private-key-format\\: v1/)){var n=t[1].split(\" \"),i=parseInt(n[1],10),o=n[2];if(!s[i])throw new Error(\"Unsupported algorithm: \"+o);return f(i,t.slice(2))}for(var p=0;t[p].match(/^\\;/);)p++;if((t[p].match(/\\. IN KEY /)||t[p].match(/\\. IN DNSKEY /))&&0===t[p+1].length)return d(t[p]);throw new Error(\"Cannot parse dnssec key\")}function d(r){var t=r.split(\" \"),i=parseInt(t[5],10);if(!s[i])throw new Error(\"Unsupported algorithm: \"+i);var o=t.slice(6,t.length).join(),p=e.from(o,\"base64\");if(s[i].match(/^RSA-/)){var m=p.readUInt8(0);if(3!=m&&1!=m)throw new Error(\"Cannot parse dnssec key: unsupported exponent length\");var d=p.slice(1,m+1);d=n.mpNormalize(d);var u=p.slice(1+m);u=n.mpNormalize(u);var l={type:\"rsa\",parts:[]};return l.parts.push({name:\"e\",data:d}),l.parts.push({name:\"n\",data:u}),new a(l)}if(\"ECDSA-P384-SHA384\"===s[i]||\"ECDSA-P256-SHA256\"===s[i]){var f=\"nistp384\",h=384;s[i].match(/^ECDSA-P256-SHA256/)&&(f=\"nistp256\",h=256);var c={type:\"ecdsa\",curve:f,size:h,parts:[{name:\"curve\",data:e.from(f)},{name:\"Q\",data:n.ecNormalize(p)}]};return new a(c)}throw new Error(\"Unsupported algorithm: \"+s[i])}function u(r){return e.from(r.split(\" \")[1],\"base64\")}function l(r){var e={};r.forEach(function(r){\"Modulus:\"===r.split(\" \")[0]?e.n=u(r):\"PublicExponent:\"===r.split(\" \")[0]?e.e=u(r):\"PrivateExponent:\"===r.split(\" \")[0]?e.d=u(r):\"Prime1:\"===r.split(\" \")[0]?e.p=u(r):\"Prime2:\"===r.split(\" \")[0]?e.q=u(r):\"Exponent1:\"===r.split(\" \")[0]?e.dmodp=u(r):\"Exponent2:\"===r.split(\" \")[0]?e.dmodq=u(r):\"Coefficient:\"===r.split(\" \")[0]&&(e.iqmp=u(r))});var a={type:\"rsa\",parts:[{name:\"e\",data:n.mpNormalize(e.e)},{name:\"n\",data:n.mpNormalize(e.n)},{name:\"d\",data:n.mpNormalize(e.d)},{name:\"p\",data:n.mpNormalize(e.p)},{name:\"q\",data:n.mpNormalize(e.q)},{name:\"dmodp\",data:n.mpNormalize(e.dmodp)},{name:\"dmodq\",data:n.mpNormalize(e.dmodq)},{name:\"iqmp\",data:n.mpNormalize(e.iqmp)}]};return new t(a)}function f(r,a){if(s[r].match(/^RSA-/))return l(a);if(\"ECDSA-P384-SHA384\"===s[r]||\"ECDSA-P256-SHA256\"===s[r]){var i=e.from(a[0].split(\" \")[1],\"base64\"),o=\"nistp384\",p=384;\"ECDSA-P256-SHA256\"===s[r]&&(o=\"nistp256\",p=256);var m=n.publicFromPrivateECDSA(o,i).part.Q.data,d={type:\"ecdsa\",curve:o,size:p,parts:[{name:\"curve\",data:e.from(o)},{name:\"d\",data:i},{name:\"Q\",data:m}]};return new t(d)}throw new Error(\"Unsupported algorithm: \"+s[r])}function h(r){var e=r.getFullYear()+\"\"+(r.getMonth()+1)+r.getUTCDate();return e+=\"\"+r.getUTCHours()+r.getUTCMinutes(),e+=r.getUTCSeconds()}function c(r){if(r&&r.hashAlgo&&\"sha1\"!==r.hashAlgo){if(\"sha256\"===r.hashAlgo)return\"8 (RSASHA256)\";if(\"sha512\"===r.hashAlgo)return\"10 (RSASHA512)\";throw new Error(\"Unknown or unsupported hash: \"+r.hashAlgo)}return\"5 (RSASHA1)\"}function v(r,a){r.part.dmodp&&r.part.dmodq||n.addRSAMissing(r);var t=\"\";t+=\"Private-key-format: v1.3\\n\",t+=\"Algorithm: \"+c(a)+\"\\n\",t+=\"Modulus: \"+n.mpDenormalize(r.part.n.data).toString(\"base64\")+\"\\n\",t+=\"PublicExponent: \"+n.mpDenormalize(r.part.e.data).toString(\"base64\")+\"\\n\",t+=\"PrivateExponent: \"+n.mpDenormalize(r.part.d.data).toString(\"base64\")+\"\\n\",t+=\"Prime1: \"+n.mpDenormalize(r.part.p.data).toString(\"base64\")+\"\\n\",t+=\"Prime2: \"+n.mpDenormalize(r.part.q.data).toString(\"base64\")+\"\\n\",t+=\"Exponent1: \"+n.mpDenormalize(r.part.dmodp.data).toString(\"base64\")+\"\\n\",t+=\"Exponent2: \"+n.mpDenormalize(r.part.dmodq.data).toString(\"base64\")+\"\\n\",t+=\"Coefficient: \"+n.mpDenormalize(r.part.iqmp.data).toString(\"base64\")+\"\\n\";var i=new Date;return t+=\"Created: \"+h(i)+\"\\n\",t+=\"Publish: \"+h(i)+\"\\n\",t+=\"Activate: \"+h(i)+\"\\n\",e.from(t,\"ascii\")}function S(r,a){var t=\"\";if(t+=\"Private-key-format: v1.3\\n\",\"nistp256\"===r.curve)t+=\"Algorithm: 13 (ECDSAP256SHA256)\\n\";else{if(\"nistp384\"!==r.curve)throw new Error(\"Unsupported curve\");t+=\"Algorithm: 14 (ECDSAP384SHA384)\\n\"}t+=\"PrivateKey: \"+r.part.d.data.toString(\"base64\")+\"\\n\";var n=new Date;return t+=\"Created: \"+h(n)+\"\\n\",t+=\"Publish: \"+h(n)+\"\\n\",t+=\"Activate: \"+h(n)+\"\\n\",e.from(t,\"ascii\")}function A(r,e){if(t.isPrivateKey(r)){if(\"rsa\"===r.type)return v(r,e);if(\"ecdsa\"===r.type)return S(r,e);throw new Error(\"Unsupported algorithm: \"+r.type)}throw a.isKey(r)?new Error('Format \"dnssec\" only supports writing private keys'):new Error(\"key is not a Key or PrivateKey\")}Object.keys(p).forEach(function(r){s[p[r]]=r.toUpperCase()});"},"sourceMaps":null,"error":null,"hash":"8b8d84b50eb909ed8ae64344b4af4d10","cacheData":{"env":{}}}