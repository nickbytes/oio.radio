{"id":"MOQE","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585257763511},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/ecc-jsbn/package.json","includedInParent":true,"mtime":1585257763156},{"name":"jsbn","loc":{"line":6,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/ecc-jsbn/lib/ec.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/jsbn/index.js"}],"generated":{"js":"var t=require(\"jsbn\").BigInteger,i=t.prototype.Barrett;function e(t,i){this.x=i,this.q=t}function r(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)}function s(){return this.x}function n(){return new e(this.q,this.x.negate().mod(this.q))}function u(t){return new e(this.q,this.x.add(t.toBigInteger()).mod(this.q))}function o(t){return new e(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}function h(t){return new e(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}function l(){return new e(this.q,this.x.square().mod(this.q))}function g(t){return new e(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}function c(i,e,r,s){this.curve=i,this.x=e,this.y=r,this.z=null==s?t.ONE:s,this.zinv=null}function a(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)}function p(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)}function f(i){return i==this||(this.isInfinity()?i.isInfinity():i.isInfinity()?this.isInfinity():!!i.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(i.z)).mod(this.curve.q).equals(t.ZERO)&&i.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(i.z)).mod(this.curve.q).equals(t.ZERO))}function m(){return null==this.x&&null==this.y||this.z.equals(t.ZERO)&&!this.y.toBigInteger().equals(t.ZERO)}function y(){return new c(this.curve,this.x,this.y.negate(),this.z)}function d(i){if(this.isInfinity())return i;if(i.isInfinity())return this;var e=i.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(i.z)).mod(this.curve.q),r=i.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(i.z)).mod(this.curve.q);if(t.ZERO.equals(r))return t.ZERO.equals(e)?this.twice():this.curve.getInfinity();var s=new t(\"3\"),n=this.x.toBigInteger(),u=this.y.toBigInteger(),o=(i.x.toBigInteger(),i.y.toBigInteger(),r.square()),h=o.multiply(r),l=n.multiply(o),g=e.square().multiply(this.z),a=g.subtract(l.shiftLeft(1)).multiply(i.z).subtract(h).multiply(r).mod(this.curve.q),p=l.multiply(s).multiply(e).subtract(u.multiply(h)).subtract(g.multiply(e)).multiply(i.z).add(e.multiply(h)).mod(this.curve.q),f=h.multiply(this.z).multiply(i.z).mod(this.curve.q);return new c(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(p),f)}function v(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var i=new t(\"3\"),e=this.x.toBigInteger(),r=this.y.toBigInteger(),s=r.multiply(this.z),n=s.multiply(r).mod(this.curve.q),u=this.curve.a.toBigInteger(),o=e.square().multiply(i);t.ZERO.equals(u)||(o=o.add(this.z.square().multiply(u)));var h=(o=o.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(n)).shiftLeft(1).multiply(s).mod(this.curve.q),l=o.multiply(i).multiply(e).subtract(n.shiftLeft(1)).shiftLeft(2).multiply(n).subtract(o.square().multiply(o)).mod(this.curve.q),g=s.square().multiply(s).shiftLeft(3).mod(this.curve.q);return new c(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(l),g)}function I(i){if(this.isInfinity())return this;if(0==i.signum())return this.curve.getInfinity();var e,r=i,s=r.multiply(new t(\"3\")),n=this.negate(),u=this;for(e=s.bitLength()-2;e>0;--e){u=u.twice();var o=s.testBit(e);o!=r.testBit(e)&&(u=u.add(o?this:n))}return u}function B(t,i,e){var r;r=t.bitLength()>e.bitLength()?t.bitLength()-1:e.bitLength()-1;for(var s=this.curve.getInfinity(),n=this.add(i);r>=0;)s=s.twice(),t.testBit(r)?s=e.testBit(r)?s.add(n):s.add(this):e.testBit(r)&&(s=s.add(i)),--r;return s}function b(t,e,r){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(r),this.infinity=new c(this,null,null),this.reducer=new i(this.q)}function w(){return this.q}function x(){return this.a}function R(){return this.b}function z(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)}function E(){return this.infinity}function L(t){return new e(this.q,t)}function O(t){this.reducer.reduce(t)}function N(i){switch(parseInt(i.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(i.length-2)/2,r=i.substr(2,e),s=i.substr(e+2,e);return new c(this,this.fromBigInteger(new t(r,16)),this.fromBigInteger(new t(s,16)));default:return null}}function M(t){if(t.isInfinity())return\"00\";var i=t.getX().toBigInteger().toString(16),e=t.getY().toBigInteger().toString(16),r=this.getQ().toString(16).length;for(r%2!=0&&r++;i.length<r;)i=\"0\"+i;for(;e.length<r;)e=\"0\"+e;return\"04\"+i+e}e.prototype.equals=r,e.prototype.toBigInteger=s,e.prototype.negate=n,e.prototype.add=u,e.prototype.subtract=o,e.prototype.multiply=h,e.prototype.square=l,e.prototype.divide=g,c.prototype.getX=a,c.prototype.getY=p,c.prototype.equals=f,c.prototype.isInfinity=m,c.prototype.negate=y,c.prototype.add=d,c.prototype.twice=v,c.prototype.multiply=I,c.prototype.multiplyTwo=B,b.prototype.getQ=w,b.prototype.getA=x,b.prototype.getB=R,b.prototype.equals=z,b.prototype.getInfinity=E,b.prototype.fromBigInteger=L,b.prototype.reduce=O,b.prototype.encodePointHex=M,b.prototype.decodePointHex=function(i){var e;switch(parseInt(i.substr(0,2),16)){case 0:return this.infinity;case 2:e=!1;case 3:null==e&&(e=!0);var r=i.length-2,s=i.substr(2,r),n=this.fromBigInteger(new t(s,16)),u=n.multiply(n.square().add(this.getA())).add(this.getB()).sqrt();if(null==u)throw\"Invalid point compression\";var o=u.toBigInteger();return o.testBit(0)!=e&&(u=this.fromBigInteger(this.getQ().subtract(o))),new c(this,n,u);case 4:case 6:case 7:r=(i.length-2)/2,s=i.substr(2,r);var h=i.substr(r+2,r);return new c(this,this.fromBigInteger(new t(s,16)),this.fromBigInteger(new t(h,16)));default:return null}},b.prototype.encodeCompressedPointHex=function(t){if(t.isInfinity())return\"00\";var i=t.getX().toBigInteger().toString(16),e=this.getQ().toString(16).length;for(e%2!=0&&e++;i.length<e;)i=\"0\"+i;return(t.getY().toBigInteger().isEven()?\"02\":\"03\")+i},e.prototype.getR=function(){if(null!=this.r)return this.r;this.r=null;var i=this.q.bitLength();i>128&&(-1==this.q.shiftRight(i-64).intValue()&&(this.r=t.ONE.shiftLeft(i).subtract(this.q)));return this.r},e.prototype.modMult=function(t,i){return this.modReduce(t.multiply(i))},e.prototype.modReduce=function(i){if(null!=this.getR()){for(var e=q.bitLength();i.bitLength()>e+1;){var r=i.shiftRight(e),s=i.subtract(r.shiftLeft(e));this.getR().equals(t.ONE)||(r=r.multiply(this.getR())),i=r.add(s)}for(;i.compareTo(q)>=0;)i=i.subtract(q)}else i=i.mod(q);return i},e.prototype.sqrt=function(){if(!this.q.testBit(0))throw\"unsupported\";if(this.q.testBit(1)){var i=new e(this.q,this.x.modPow(this.q.shiftRight(2).add(t.ONE),this.q));return i.square().equals(this)?i:null}var r=this.q.subtract(t.ONE),s=r.shiftRight(1);if(!this.x.modPow(s,this.q).equals(t.ONE))return null;var n,u,o=r.shiftRight(2).shiftLeft(1).add(t.ONE),h=this.x,l=modDouble(modDouble(h));do{var g;do{g=new t(this.q.bitLength(),new SecureRandom)}while(g.compareTo(this.q)>=0||!g.multiply(g).subtract(l).modPow(s,this.q).equals(r));var c=this.lucasSequence(g,h,o);if(n=c[0],u=c[1],this.modMult(u,u).equals(l))return u.testBit(0)&&(u=u.add(q)),u=u.shiftRight(1),new e(q,u)}while(n.equals(t.ONE)||n.equals(r));return null},e.prototype.lucasSequence=function(i,e,r){for(var s=r.bitLength(),n=r.getLowestSetBit(),u=t.ONE,o=t.TWO,h=i,l=t.ONE,g=t.ONE,c=s-1;c>=n+1;--c)l=this.modMult(l,g),r.testBit(c)?(g=this.modMult(l,e),u=this.modMult(u,h),o=this.modReduce(h.multiply(o).subtract(i.multiply(l))),h=this.modReduce(h.multiply(h).subtract(g.shiftLeft(1)))):(g=l,u=this.modReduce(u.multiply(o).subtract(l)),h=this.modReduce(h.multiply(o).subtract(i.multiply(l))),o=this.modReduce(o.multiply(o).subtract(l.shiftLeft(1))));l=this.modMult(l,g),g=this.modMult(l,e),u=this.modReduce(u.multiply(o).subtract(l)),o=this.modReduce(h.multiply(o).subtract(i.multiply(l))),l=this.modMult(l,g);for(c=1;c<=n;++c)u=this.modMult(u,o),o=this.modReduce(o.multiply(o).subtract(l.shiftLeft(1))),l=this.modMult(l,l);return[u,o]};var S={ECCurveFp:b,ECPointFp:c,ECFieldElementFp:e};module.exports=S;"},"sourceMaps":null,"error":null,"hash":"a1d6e883524e73bf13b99cf84978167f","cacheData":{"env":{}}}