{"id":"uiyZ","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585257763511},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":10,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"asn1","loc":{"line":11,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/asn1/lib/index.js"},{"name":"safer-buffer","loc":{"line":12,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"../algs","loc":{"line":13,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/algs.js"},{"name":"../utils","loc":{"line":14,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"../key","loc":{"line":16,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/key.js"},{"name":"../private-key","loc":{"line":17,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/private-key.js"},{"name":"./pem","loc":{"line":18,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js"},{"name":"./pkcs8","loc":{"line":20,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js"}],"generated":{"js":"\nmodule.exports={read:p,readPkcs1:w,write:o,writePkcs1:k};var e=require(\"assert-plus\"),r=require(\"asn1\"),t=require(\"safer-buffer\").Buffer,a=require(\"../algs\"),n=require(\"../utils\"),i=require(\"../key\"),u=require(\"../private-key\"),d=require(\"./pem\"),f=require(\"./pkcs8\"),c=f.readECDSACurve;function p(e,r){return d.read(e,r,\"pkcs1\")}function o(e,r){return d.write(e,r,\"pkcs1\")}function s(t,a){return e.strictEqual(t.peek(),r.Ber.Integer,a+\" is not an Integer\"),n.mpNormalize(t.readString(r.Ber.Integer,!0))}function w(e,r,t){switch(e){case\"RSA\":if(\"public\"===r)return B(t);if(\"private\"===r)return g(t);throw new Error(\"Unknown key type: \"+r);case\"DSA\":if(\"public\"===r)return q(t);if(\"private\"===r)return m(t);throw new Error(\"Unknown key type: \"+r);case\"EC\":case\"ECDSA\":if(\"private\"===r)return I(t);if(\"public\"===r)return S(t);throw new Error(\"Unknown key type: \"+r);case\"EDDSA\":case\"EdDSA\":if(\"private\"===r)return v(t);throw new Error(r+\" keys not supported with EdDSA\");default:throw new Error(\"Unknown key algo: \"+e)}}function B(e){var r=s(e,\"modulus\"),t=s(e,\"exponent\");return new i({type:\"rsa\",parts:[{name:\"e\",data:t},{name:\"n\",data:r}]})}function g(r){var t=s(r,\"version\");e.strictEqual(t[0],0);var a=s(r,\"modulus\"),n=s(r,\"public exponent\"),i=s(r,\"private exponent\"),d=s(r,\"prime1\"),f=s(r,\"prime2\"),c=s(r,\"exponent1\"),p=s(r,\"exponent2\"),o=s(r,\"iqmp\");return new u({type:\"rsa\",parts:[{name:\"n\",data:a},{name:\"e\",data:n},{name:\"d\",data:i},{name:\"iqmp\",data:o},{name:\"p\",data:d},{name:\"q\",data:f},{name:\"dmodp\",data:c},{name:\"dmodq\",data:p}]})}function m(r){var t=s(r,\"version\");e.strictEqual(t.readUInt8(0),0);var a=s(r,\"p\"),n=s(r,\"q\"),i=s(r,\"g\"),d=s(r,\"y\"),f=s(r,\"x\");return new u({type:\"dsa\",parts:[{name:\"p\",data:a},{name:\"q\",data:n},{name:\"g\",data:i},{name:\"y\",data:d},{name:\"x\",data:f}]})}function v(t){var a=s(t,\"version\");e.strictEqual(a.readUInt8(0),1);var i=t.readString(r.Ber.OctetString,!0);t.readSequence(160);var d=t.readOID();e.strictEqual(d,\"1.3.101.112\",\"the ed25519 curve identifier\"),t.readSequence(161);var f=n.readBitString(t),c={type:\"ed25519\",parts:[{name:\"A\",data:n.zeroPadToLength(f,32)},{name:\"k\",data:i}]};return new u(c)}function q(e){var r=s(e,\"y\"),t=s(e,\"p\"),a=s(e,\"q\"),n=s(e,\"g\");return new i({type:\"dsa\",parts:[{name:\"y\",data:r},{name:\"p\",data:t},{name:\"q\",data:a},{name:\"g\",data:n}]})}function S(u){u.readSequence();var d=u.readOID();e.strictEqual(d,\"1.2.840.10045.2.1\",\"must be ecPublicKey\");for(var f,c=u.readOID(),p=Object.keys(a.curves),o=0;o<p.length;++o){var s=p[o];if(a.curves[s].pkcs8oid===c){f=s;break}}e.string(f,\"a known ECDSA named curve\");var w=u.readString(r.Ber.BitString,!0);w=n.ecNormalize(w);var B={type:\"ecdsa\",parts:[{name:\"curve\",data:t.from(f)},{name:\"Q\",data:w}]};return new i(B)}function I(a){var i=s(a,\"version\");e.strictEqual(i.readUInt8(0),1);var d=a.readString(r.Ber.OctetString,!0);a.readSequence(160);var f=c(a);e.string(f,\"a known elliptic curve\"),a.readSequence(161);var p=a.readString(r.Ber.BitString,!0);p=n.ecNormalize(p);var o={type:\"ecdsa\",parts:[{name:\"curve\",data:t.from(f)},{name:\"Q\",data:p},{name:\"d\",data:d}]};return new u(o)}function k(e,r){switch(e.startSequence(),r.type){case\"rsa\":u.isPrivateKey(r)?l(e,r):y(e,r);break;case\"dsa\":u.isPrivateKey(r)?E(e,r):D(e,r);break;case\"ecdsa\":u.isPrivateKey(r)?A(e,r):b(e,r);break;case\"ed25519\":u.isPrivateKey(r)?h(e,r):O(e,r);break;default:throw new Error(\"Unknown key algo: \"+r.type)}e.endSequence()}function y(e,t){e.writeBuffer(t.part.n.data,r.Ber.Integer),e.writeBuffer(t.part.e.data,r.Ber.Integer)}function l(e,a){var i=t.from([0]);e.writeBuffer(i,r.Ber.Integer),e.writeBuffer(a.part.n.data,r.Ber.Integer),e.writeBuffer(a.part.e.data,r.Ber.Integer),e.writeBuffer(a.part.d.data,r.Ber.Integer),e.writeBuffer(a.part.p.data,r.Ber.Integer),e.writeBuffer(a.part.q.data,r.Ber.Integer),a.part.dmodp&&a.part.dmodq||n.addRSAMissing(a),e.writeBuffer(a.part.dmodp.data,r.Ber.Integer),e.writeBuffer(a.part.dmodq.data,r.Ber.Integer),e.writeBuffer(a.part.iqmp.data,r.Ber.Integer)}function E(e,a){var n=t.from([0]);e.writeBuffer(n,r.Ber.Integer),e.writeBuffer(a.part.p.data,r.Ber.Integer),e.writeBuffer(a.part.q.data,r.Ber.Integer),e.writeBuffer(a.part.g.data,r.Ber.Integer),e.writeBuffer(a.part.y.data,r.Ber.Integer),e.writeBuffer(a.part.x.data,r.Ber.Integer)}function D(e,t){e.writeBuffer(t.part.y.data,r.Ber.Integer),e.writeBuffer(t.part.p.data,r.Ber.Integer),e.writeBuffer(t.part.q.data,r.Ber.Integer),e.writeBuffer(t.part.g.data,r.Ber.Integer)}function b(t,i){t.startSequence(),t.writeOID(\"1.2.840.10045.2.1\");var u=i.part.curve.data.toString(),d=a.curves[u].pkcs8oid;e.string(d,\"a known ECDSA named curve\"),t.writeOID(d),t.endSequence();var f=n.ecNormalize(i.part.Q.data,!0);t.writeBuffer(f,r.Ber.BitString)}function A(i,u){var d=t.from([1]);i.writeBuffer(d,r.Ber.Integer),i.writeBuffer(u.part.d.data,r.Ber.OctetString),i.startSequence(160);var f=u.part.curve.data.toString(),c=a.curves[f].pkcs8oid;e.string(c,\"a known ECDSA named curve\"),i.writeOID(c),i.endSequence(),i.startSequence(161);var p=n.ecNormalize(u.part.Q.data,!0);i.writeBuffer(p,r.Ber.BitString),i.endSequence()}function h(e,a){var i=t.from([1]);e.writeBuffer(i,r.Ber.Integer),e.writeBuffer(a.part.k.data,r.Ber.OctetString),e.startSequence(160),e.writeOID(\"1.3.101.112\"),e.endSequence(),e.startSequence(161),n.writeBitString(e,a.part.A.data),e.endSequence()}function O(e,r){throw new Error(\"Public keys are not supported for EdDSA PKCS#1\")}"},"sourceMaps":null,"error":null,"hash":"9ca72e77a2af5561ad7e350cb241ff5f","cacheData":{"env":{}}}