{"id":"VpwZ","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585391671622},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":9,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"asn1","loc":{"line":10,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/asn1/lib/index.js"},{"name":"safer-buffer","loc":{"line":11,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"../algs","loc":{"line":12,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/algs.js"},{"name":"../utils","loc":{"line":13,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"crypto","loc":{"line":14,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/.config/yarn/global/node_modules/crypto-browserify/index.js"},{"name":"../key","loc":{"line":16,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/key.js"},{"name":"../private-key","loc":{"line":17,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/private-key.js"},{"name":"./pem","loc":{"line":18,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js"},{"name":"./rfc4253","loc":{"line":19,"column":22},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/rfc4253.js"},{"name":"../ssh-buffer","loc":{"line":20,"column":24},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/ssh-buffer.js"},{"name":"../errors","loc":{"line":21,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/errors.js"},{"name":"bcrypt-pbkdf","loc":{"line":191,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/bcrypt-pbkdf/index.js"}],"generated":{"js":"\nmodule.exports={read:l,readSSHPrivate:h,write:y};var e,r=require(\"assert-plus\"),t=require(\"asn1\"),n=require(\"safer-buffer\").Buffer,i=require(\"../algs\"),a=require(\"../utils\"),o=require(\"crypto\"),s=require(\"../key\"),f=require(\"../private-key\"),p=require(\"./pem\"),u=require(\"./rfc4253\"),c=require(\"../ssh-buffer\"),d=require(\"../errors\");function l(e,r){return p.read(e,r)}var w=\"openssh-key-v1\";function h(t,i,s){var f=(i=new c({buffer:i})).readCString();r.strictEqual(f,w,\"bad magic string\");var p=i.readString(),l=i.readString(),h=i.readBuffer();if(1!==i.readInt())throw new Error(\"OpenSSH-format key file contains multiple keys: this is unsupported.\");var y=i.readBuffer();if(\"public\"===t)return r.ok(i.atEnd(),\"excess bytes left after key\"),u.read(y);var v=i.readBuffer();r.ok(i.atEnd(),\"excess bytes left after key\");var k=new c({buffer:h});switch(l){case\"none\":if(\"none\"!==p)throw new Error('OpenSSH-format key uses KDF \"none\" but specifies a cipher other than \"none\"');break;case\"bcrypt\":var S=k.readBuffer(),b=k.readInt(),g=a.opensshCipherInfo(p);if(void 0===e&&(e=require(\"bcrypt-pbkdf\")),\"string\"==typeof s.passphrase&&(s.passphrase=n.from(s.passphrase,\"utf-8\")),!n.isBuffer(s.passphrase))throw new d.KeyEncryptedError(s.filename,\"OpenSSH\");var m=new Uint8Array(s.passphrase),E=new Uint8Array(S),B=new Uint8Array(g.keySize+g.blockSize);if(0!==e.pbkdf(m,m.length,E,E.length,B,B.length,b))throw new Error(\"bcrypt_pbkdf function returned failure, parameters invalid\");var I=(B=n.from(B)).slice(0,g.keySize),q=B.slice(g.keySize,g.keySize+g.blockSize),z=o.createDecipheriv(g.opensslName,I,q);z.setAutoPadding(!1);var P,A=[];for(z.once(\"error\",function(e){if(-1!==e.toString().indexOf(\"bad decrypt\"))throw new Error(\"Incorrect passphrase supplied, could not decrypt key\");throw e}),z.write(v),z.end();null!==(P=z.read());)A.push(P);v=n.concat(A);break;default:throw new Error('OpenSSH-format key uses unknown KDF \"'+l+'\"')}if((i=new c({buffer:v})).readInt()!==i.readInt())throw new Error(\"Incorrect passphrase supplied, could not decrypt key\");var U={},K=u.readInternal(U,\"private\",i.remainder());i.skip(U.consumed);var C=i.readString();return K.comment=C,K}function y(t,i){var s;s=f.isPrivateKey(t)?t.toPublic():t;var p,u,d=\"none\",l=\"none\",h=n.alloc(0),y={blockSize:8};if(void 0!==i&&(\"string\"==typeof(p=i.passphrase)&&(p=n.from(p,\"utf-8\")),void 0!==p&&(r.buffer(p,\"options.passphrase\"),r.optionalString(i.cipher,\"options.cipher\"),void 0===(d=i.cipher)&&(d=\"aes128-ctr\"),y=a.opensshCipherInfo(d),l=\"bcrypt\")),f.isPrivateKey(t)){u=new c({});var v=o.randomBytes(4).readUInt32BE(0);u.writeInt(v),u.writeInt(v),u.write(t.toBuffer(\"rfc4253\")),u.writeString(t.comment||\"\");for(var k=1;u._offset%y.blockSize!=0;)u.writeChar(k++);u=u.toBuffer()}switch(l){case\"none\":break;case\"bcrypt\":var S=o.randomBytes(16),b=new c({});b.writeBuffer(S),b.writeInt(16),h=b.toBuffer(),void 0===e&&(e=require(\"bcrypt-pbkdf\"));var g=new Uint8Array(p),m=new Uint8Array(S),E=new Uint8Array(y.keySize+y.blockSize);if(0!==e.pbkdf(g,g.length,m,m.length,E,E.length,16))throw new Error(\"bcrypt_pbkdf function returned failure, parameters invalid\");var B=(E=n.from(E)).slice(0,y.keySize),I=E.slice(y.keySize,y.keySize+y.blockSize),q=o.createCipheriv(y.opensslName,B,I);q.setAutoPadding(!1);var z,P=[];for(q.once(\"error\",function(e){throw e}),q.write(u),q.end();null!==(z=q.read());)P.push(z);u=n.concat(P);break;default:throw new Error(\"Unsupported kdf \"+l)}var A,U=new c({});U.writeCString(w),U.writeString(d),U.writeString(l),U.writeBuffer(h),U.writeInt(1),U.writeBuffer(s.toBuffer(\"rfc4253\")),u&&U.writeBuffer(u),U=U.toBuffer(),A=f.isPrivateKey(t)?\"OPENSSH PRIVATE KEY\":\"OPENSSH PUBLIC KEY\";var K=U.toString(\"base64\"),C=K.length+K.length/70+18+16+2*A.length+10,H=0;H+=(U=n.alloc(C)).write(\"-----BEGIN \"+A+\"-----\\n\",H);for(var O=0;O<K.length;){var N=O+70;N>K.length&&(N=K.length),H+=U.write(K.slice(O,N),H),U[H++]=10,O=N}return H+=U.write(\"-----END \"+A+\"-----\\n\",H),U.slice(0,H)}"},"sourceMaps":null,"error":null,"hash":"3b04a0775380095ec66d646549e9886c","cacheData":{"env":{}}}