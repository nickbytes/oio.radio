{"id":"FRXr","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585391671622},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":8,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"asn1","loc":{"line":9,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/asn1/lib/index.js"},{"name":"crypto","loc":{"line":10,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/.config/yarn/global/node_modules/crypto-browserify/index.js"},{"name":"safer-buffer","loc":{"line":11,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"../algs","loc":{"line":12,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/algs.js"},{"name":"../utils","loc":{"line":13,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"../key","loc":{"line":14,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/key.js"},{"name":"../private-key","loc":{"line":15,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/private-key.js"},{"name":"./pkcs1","loc":{"line":17,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs1.js"},{"name":"./pkcs8","loc":{"line":18,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pkcs8.js"},{"name":"./ssh-private","loc":{"line":19,"column":22},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/ssh-private.js"},{"name":"./rfc4253","loc":{"line":20,"column":22},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/rfc4253.js"},{"name":"../errors","loc":{"line":22,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/pem.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/errors.js"}],"generated":{"js":"\nmodule.exports={read:P,write:k};var e=require(\"assert-plus\"),r=require(\"asn1\"),t=require(\"crypto\"),a=require(\"safer-buffer\").Buffer,s=require(\"../algs\"),i=require(\"../utils\"),o=require(\"../key\"),n=require(\"../private-key\"),c=require(\"./pkcs1\"),p=require(\"./pkcs8\"),f=require(\"./ssh-private\"),u=require(\"./rfc4253\"),h=require(\"../errors\"),d=\"1.2.840.113549.1.5.13\",l=\"1.2.840.113549.1.5.12\",E={\"1.2.840.113549.3.7\":\"3des-cbc\",\"2.16.840.1.101.3.4.1.2\":\"aes128-cbc\",\"2.16.840.1.101.3.4.1.42\":\"aes256-cbc\"},w={};Object.keys(E).forEach(function(e){w[E[e]]=e});var v={\"1.2.840.113549.2.7\":\"sha1\",\"1.2.840.113549.2.9\":\"sha256\",\"1.2.840.113549.2.11\":\"sha512\"},y={};function P(s,o,n){var w=s;\"string\"!=typeof s&&(e.buffer(s,\"buf\"),s=s.toString(\"ascii\"));for(var y,P,k=s.trim().split(/[\\r\\n]+/g),q=-1;!y&&q<k.length;)y=k[++q].match(/[-]+[ ]*BEGIN ([A-Z0-9][A-Za-z0-9]+ )?(PUBLIC|PRIVATE) KEY[ ]*[-]+/);e.ok(y,\"invalid PEM header\");for(var g=k.length;!P&&g>0;)P=k[--g].match(/[-]+[ ]*END ([A-Z0-9][A-Za-z0-9]+ )?(PUBLIC|PRIVATE) KEY[ ]*[-]+/);e.ok(P,\"invalid PEM footer\"),e.equal(y[2],P[2]);var S,B=y[2].toLowerCase();y[1]&&(e.equal(y[1],P[1],\"PEM header and footer mismatch\"),S=y[1].trim()),k=k.slice(q,g+1);for(var I,m,K,b={};y=(k=k.slice(1))[0].match(/^([A-Za-z0-9-]+): (.+)$/);)b[y[1].toLowerCase()]=y[2];if(k=k.slice(0,-1).join(\"\"),s=a.from(k,\"base64\"),b[\"proc-type\"]){var C=b[\"proc-type\"].split(\",\");if(\"4\"===C[0]&&\"ENCRYPTED\"===C[1]){if(\"string\"==typeof o.passphrase&&(o.passphrase=a.from(o.passphrase,\"utf-8\")),!a.isBuffer(o.passphrase))throw new h.KeyEncryptedError(o.filename,\"PEM\");C=b[\"dek-info\"].split(\",\"),e.ok(2===C.length),I=C[0].toLowerCase(),K=a.from(C[1],\"hex\"),m=i.opensslKeyDeriv(I,K,o.passphrase,1).key}}if(S&&\"encrypted\"===S.toLowerCase()){var D,A=new r.BerReader(s);A.readSequence(),A.readSequence(),D=A.offset+A.length;var L=A.readOID();if(L!==d)throw new Error(\"Unsupported PEM/PKCS8 encryption scheme: \"+L);A.readSequence(),A.readSequence();var O=A.offset+A.length,R=A.readOID();if(R!==l)throw new Error(\"Unsupported PBES2 KDF: \"+R);A.readSequence();var U=A.readString(r.Ber.OctetString,!0),Y=A.readInt(),M=\"sha1\";if(A.offset<O){A.readSequence();var N=A.readOID();if(void 0===(M=v[N]))throw new Error(\"Unsupported PBKDF2 hash: \"+N)}A._offset=O,A.readSequence();var T=A.readOID();if(void 0===(I=E[T]))throw new Error(\"Unsupported PBES2 cipher: \"+T);if(K=A.readString(r.Ber.OctetString,!0),A._offset=D,s=A.readString(r.Ber.OctetString,!0),\"string\"==typeof o.passphrase&&(o.passphrase=a.from(o.passphrase,\"utf-8\")),!a.isBuffer(o.passphrase))throw new h.KeyEncryptedError(o.filename,\"PEM\");var Z=i.opensshCipherInfo(I);I=Z.opensslName,m=i.pbkdf2(M,U,Y,Z.keySize,o.passphrase),S=void 0}if(I&&m&&K){var j,z=t.createDecipheriv(I,m,K),V=[];for(z.once(\"error\",function(e){if(-1!==e.toString().indexOf(\"bad decrypt\"))throw new Error(\"Incorrect passphrase supplied, could not decrypt key\");throw e}),z.write(s),z.end();null!==(j=z.read());)V.push(j);s=a.concat(V)}if(S&&\"openssh\"===S.toLowerCase())return f.readSSHPrivate(B,s,o);if(S&&\"ssh2\"===S.toLowerCase())return u.readType(B,s,o);var x=new r.BerReader(s);return x.originalInput=w,x.readSequence(),S?(n&&e.strictEqual(n,\"pkcs1\"),c.readPkcs1(S,B,x)):(n&&e.strictEqual(n,\"pkcs8\"),p.readPkcs8(S,B,x))}function k(t,s,i){e.object(t);var f,u={ecdsa:\"EC\",rsa:\"RSA\",dsa:\"DSA\",ed25519:\"EdDSA\"}[t.type],h=new r.BerWriter;if(n.isPrivateKey(t))i&&\"pkcs8\"===i?(f=\"PRIVATE KEY\",p.writePkcs8(h,t)):(i&&e.strictEqual(i,\"pkcs1\"),f=u+\" PRIVATE KEY\",c.writePkcs1(h,t));else{if(!o.isKey(t))throw new Error(\"key is not a Key or PrivateKey\");i&&\"pkcs1\"===i?(f=u+\" PUBLIC KEY\",c.writePkcs1(h,t)):(i&&e.strictEqual(i,\"pkcs8\"),f=\"PUBLIC KEY\",p.writePkcs8(h,t))}var d=h.buffer.toString(\"base64\"),l=d.length+d.length/64+18+16+2*f.length+10,E=a.alloc(l),w=0;w+=E.write(\"-----BEGIN \"+f+\"-----\\n\",w);for(var v=0;v<d.length;){var y=v+64;y>d.length&&(y=d.length),w+=E.write(d.slice(v,y),w),E[w++]=10,v=y}return w+=E.write(\"-----END \"+f+\"-----\\n\",w),E.slice(0,w)}Object.keys(v).forEach(function(e){y[v[e]]=e});"},"sourceMaps":null,"error":null,"hash":"2de0d425167428a5c2c3e02199531d43","cacheData":{"env":{}}}