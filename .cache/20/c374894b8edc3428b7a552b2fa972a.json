{"id":"iC2A","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585391671622},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":15,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"../ssh-buffer","loc":{"line":16,"column":24},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/ssh-buffer.js"},{"name":"crypto","loc":{"line":17,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/.config/yarn/global/node_modules/crypto-browserify/index.js"},{"name":"safer-buffer","loc":{"line":18,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"../algs","loc":{"line":19,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/algs.js"},{"name":"../key","loc":{"line":20,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/key.js"},{"name":"../private-key","loc":{"line":21,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/private-key.js"},{"name":"../identity","loc":{"line":22,"column":23},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/identity.js"},{"name":"./rfc4253","loc":{"line":23,"column":22},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/rfc4253.js"},{"name":"../signature","loc":{"line":24,"column":24},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js"},{"name":"../utils","loc":{"line":25,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"../certificate","loc":{"line":26,"column":26},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/formats/openssh-cert.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/certificate.js"}],"generated":{"js":"\nmodule.exports={read:g,verify:h,sign:m,signAsync:B,write:b,fromBuffer:w,toBuffer:E};var e=require(\"assert-plus\"),r=require(\"../ssh-buffer\"),t=require(\"crypto\"),n=require(\"safer-buffer\").Buffer,s=require(\"../algs\"),a=require(\"../key\"),i=require(\"../private-key\"),u=require(\"../identity\"),o=require(\"./rfc4253\"),f=require(\"../signature\"),c=require(\"../utils\"),d=require(\"../certificate\");function h(e,r){return!1}var p={user:1,host:2};Object.keys(p).forEach(function(e){p[p[e]]=e});var v=/^ecdsa-sha2-([^@-]+)-cert-v01@openssh.com$/;function g(e,r){n.isBuffer(e)&&(e=e.toString(\"ascii\"));var t=e.trim().split(/[ \\t\\n]+/g);if(t.length<2||t.length>3)throw new Error(\"Not a valid SSH certificate line\");var s=t[0],a=t[1];return w(a=n.from(a,\"base64\"),s)}function w(t,n,i){var h=new r({buffer:t}),g=h.readString();if(void 0!==n&&g!==n)throw new Error(\"SSH certificate algorithm mismatch\");void 0===n&&(n=g);var w={signatures:{}};w.signatures.openssh={},w.signatures.openssh.nonce=h.readBuffer();var y={},m=y.parts=[];y.type=S(n);for(var B=s.info[y.type].parts.length;m.length<B;)m.push(h.readPart());e.ok(m.length>=1,\"key must have at least one part\");var b=s.info[y.type];if(\"ecdsa\"===y.type){var E=v.exec(n);e.ok(null!==E),e.strictEqual(E[1],m[0].data.toString())}for(var I=0;I<b.parts.length;++I)if(m[I].name=b.parts[I],\"curve\"!==m[I].name&&!1!==b.normalize){var q=m[I];q.data=c.mpNormalize(q.data)}w.subjectKey=new a(y),w.serial=h.readInt64();var j=p[h.readInt()];e.string(j,\"valid cert type\"),w.signatures.openssh.keyId=h.readString();for(var k=[],U=h.readBuffer(),K=new r({buffer:U});!K.atEnd();)k.push(K.readString());0===k.length&&(k=[\"*\"]),w.subjects=k.map(function(e){if(\"user\"===j)return u.forUser(e);if(\"host\"===j)return u.forHost(e);throw new Error(\"Unknown identity type \"+j)}),w.validFrom=l(h.readInt64()),w.validUntil=l(h.readInt64());for(var x,H=[],M=new r({buffer:h.readBuffer()});!M.atEnd();)(x={critical:!0}).name=M.readString(),x.data=M.readBuffer(),H.push(x);for(M=new r({buffer:h.readBuffer()});!M.atEnd();)(x={critical:!1}).name=M.readString(),x.data=M.readBuffer(),H.push(x);w.signatures.openssh.exts=H,h.readBuffer();var z=h.readBuffer();w.issuerKey=o.read(z),w.issuer=u.forHost(\"**\");var F=h.readBuffer();return w.signatures.openssh.signature=f.parse(F,w.issuerKey.type,\"ssh\"),void 0!==i&&(i.remainder=h.remainder(),i.consumed=h._offset),new d(w)}function l(e){var r=4294967296*e.readUInt32BE(0);r+=e.readUInt32BE(4);var t=new Date;return t.setTime(1e3*r),t.sourceInt64=e,t}function y(e){if(void 0!==e.sourceInt64)return e.sourceInt64;var r=Math.round(e.getTime()/1e3),t=Math.floor(r/4294967296),s=Math.floor(r%4294967296),a=n.alloc(8);return a.writeUInt32BE(t,0),a.writeUInt32BE(s,4),a}function m(e,r){void 0===e.signatures.openssh&&(e.signatures.openssh={});try{var t=E(e,!0)}catch(i){return delete e.signatures.openssh,!1}var n=e.signatures.openssh,s=void 0;\"rsa\"!==r.type&&\"dsa\"!==r.type||(s=\"sha1\");var a=r.createSign(s);return a.write(t),n.signature=a.sign(),!0}function B(e,r,t){void 0===e.signatures.openssh&&(e.signatures.openssh={});try{var n=E(e,!0)}catch(a){return delete e.signatures.openssh,void t(a)}var s=e.signatures.openssh;r(n,function(e,r){if(e)t(e);else{try{r.toBuffer(\"ssh\")}catch(a){return void t(a)}s.signature=r,t()}})}function b(e,r){void 0===r&&(r={});var t=E(e),n=I(e.subjectKey)+\" \"+t.toString(\"base64\");return r.comment&&(n=n+\" \"+r.comment),n}function E(a,i){e.object(a.signatures.openssh,\"signature for openssh format\");var u=a.signatures.openssh;void 0===u.nonce&&(u.nonce=t.randomBytes(16));var f=new r({});f.writeString(I(a.subjectKey)),f.writeBuffer(u.nonce);var c=a.subjectKey;s.info[c.type].parts.forEach(function(e){f.writePart(c.part[e])}),f.writeInt64(a.serial);var d=a.subjects[0].type;e.notStrictEqual(d,\"unknown\"),a.subjects.forEach(function(r){e.strictEqual(r.type,d)}),d=p[d],f.writeInt(d),void 0===u.keyId&&(u.keyId=a.subjects[0].type+\"_\"+(a.subjects[0].uid||a.subjects[0].hostname)),f.writeString(u.keyId);var h=new r({});a.subjects.forEach(function(e){d===p.host?h.writeString(e.hostname):d===p.user&&h.writeString(e.uid)}),f.writeBuffer(h.toBuffer()),f.writeInt64(y(a.validFrom)),f.writeInt64(y(a.validUntil));var v=u.exts;void 0===v&&(v=[]);var g=new r({});return v.forEach(function(e){!0===e.critical&&(g.writeString(e.name),g.writeBuffer(e.data))}),f.writeBuffer(g.toBuffer()),g=new r({}),v.forEach(function(e){!0!==e.critical&&(g.writeString(e.name),g.writeBuffer(e.data))}),f.writeBuffer(g.toBuffer()),f.writeBuffer(n.alloc(0)),h=o.write(a.issuerKey),f.writeBuffer(h),i||f.writeBuffer(u.signature.toBuffer(\"ssh\")),f.toBuffer()}function S(e){if(\"ssh-rsa-cert-v01@openssh.com\"===e)return\"rsa\";if(\"ssh-dss-cert-v01@openssh.com\"===e)return\"dsa\";if(e.match(v))return\"ecdsa\";if(\"ssh-ed25519-cert-v01@openssh.com\"===e)return\"ed25519\";throw new Error(\"Unsupported cert type \"+e)}function I(e){if(\"rsa\"===e.type)return\"ssh-rsa-cert-v01@openssh.com\";if(\"dsa\"===e.type)return\"ssh-dss-cert-v01@openssh.com\";if(\"ecdsa\"===e.type)return\"ecdsa-sha2-\"+e.curve+\"-cert-v01@openssh.com\";if(\"ed25519\"===e.type)return\"ssh-ed25519-cert-v01@openssh.com\";throw new Error(\"Unsupported key type \"+e.type)}"},"sourceMaps":null,"error":null,"hash":"418854534e4cd73e9e6a5ebf099c9a35","cacheData":{"env":{}}}