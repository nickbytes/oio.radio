{"id":"jH6g","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585391671622},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":9,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"crypto","loc":{"line":10,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/.config/yarn/global/node_modules/crypto-browserify/index.js"},{"name":"safer-buffer","loc":{"line":11,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"./algs","loc":{"line":12,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/algs.js"},{"name":"./utils","loc":{"line":13,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"tweetnacl","loc":{"line":14,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/tweetnacl/nacl-fast.js"},{"name":"./key","loc":{"line":16,"column":18},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/key.js"},{"name":"./private-key","loc":{"line":17,"column":25},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/private-key.js"},{"name":"ecc-jsbn","loc":{"line":21,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/ecc-jsbn/index.js"},{"name":"ecc-jsbn/lib/ec","loc":{"line":22,"column":17},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/ecc-jsbn/lib/ec.js"},{"name":"jsbn","loc":{"line":23,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/dhe.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/jsbn/index.js"}],"generated":{"js":"\nmodule.exports={DiffieHellman:d,generateECDSA:m,generateED25519:l};var e=require(\"assert-plus\"),t=require(\"crypto\"),r=require(\"safer-buffer\").Buffer,i=require(\"./algs\"),a=require(\"./utils\"),s=require(\"tweetnacl\"),h=require(\"./key\"),n=require(\"./private-key\"),p=void 0!==t.createECDH,o=require(\"ecc-jsbn\"),u=require(\"ecc-jsbn/lib/ec\"),c=require(\"jsbn\").BigInteger;function d(e){if(a.assertCompatible(e,h,[1,4],\"key\"),this._isPriv=n.isPrivateKey(e,[1,3]),this._algo=e.type,this._curve=e.curve,this._key=e,\"dsa\"===e.type){if(!p)throw new Error(\"Due to bugs in the node 0.10 crypto API, node 0.12.x or later is required to use DH\");this._dh=t.createDiffieHellman(e.part.p.data,void 0,e.part.g.data,void 0),this._p=e.part.p,this._g=e.part.g,this._isPriv&&this._dh.setPrivateKey(e.part.x.data),this._dh.setPublicKey(e.part.y.data)}else if(\"ecdsa\"===e.type){if(!p)return this._ecParams=new y(this._curve),void(this._isPriv&&(this._priv=new _(this._ecParams,e.part.d.data)));var r={nistp256:\"prime256v1\",nistp384:\"secp384r1\",nistp521:\"secp521r1\"}[e.curve];if(this._dh=t.createECDH(r),\"object\"!=typeof this._dh||\"function\"!=typeof this._dh.setPrivateKey)return p=!1,void d.call(this,e);this._isPriv&&this._dh.setPrivateKey(e.part.d.data),this._dh.setPublicKey(e.part.Q.data)}else{if(\"curve25519\"!==e.type)throw new Error(\"DH not supported for \"+e.type+\" keys\");this._isPriv&&(a.assertCompatible(e,n,[1,5],\"key\"),this._priv=e.part.k.data)}}function y(t){var r=i.curves[t];e.object(r);var a=new c(r.p),s=new c(r.a),h=new c(r.b),n=new c(r.n),p=c.ONE,o=new u.ECCurveFp(a,s,h),d=o.decodePointHex(r.G.toString(\"hex\"));this.curve=o,this.g=d,this.n=n,this.h=p}function v(e,t){this._params=e,0===t[0]&&(t=t.slice(1)),this._pub=e.getCurve().decodePointHex(t.toString(\"hex\"))}function _(e,t){this._params=e,this._priv=new c(a.mpNormalize(t))}function l(){var t=s.sign.keyPair(),i=r.from(t.secretKey),a=r.from(t.publicKey);e.strictEqual(i.length,64),e.strictEqual(a.length,32);var h=[];return h.push({name:\"A\",data:a}),h.push({name:\"k\",data:i.slice(0,32)}),new n({type:\"ed25519\",parts:h})}function m(e){var i=[];if(p){var a={nistp256:\"prime256v1\",nistp384:\"secp384r1\",nistp521:\"secp521r1\"}[e],s=t.createECDH(a);return s.generateKeys(),i.push({name:\"curve\",data:r.from(e)}),i.push({name:\"Q\",data:s.getPublicKey()}),i.push({name:\"d\",data:s.getPrivateKey()}),new n({type:\"ecdsa\",curve:e,parts:i})}var h=new y(e),o=h.getN(),u=Math.ceil((o.bitLength()+64)/8),d=new c(t.randomBytes(u)),v=o.subtract(c.ONE),_=d.mod(v).add(c.ONE),l=h.getG().multiply(_);return _=r.from(_.toByteArray()),l=r.from(h.getCurve().encodePointHex(l),\"hex\"),i.push({name:\"curve\",data:r.from(e)}),i.push({name:\"Q\",data:l}),i.push({name:\"d\",data:_}),new n({type:\"ecdsa\",curve:e,parts:i})}d.prototype.getPublicKey=function(){return this._isPriv?this._key.toPublic():this._key},d.prototype.getPrivateKey=function(){return this._isPriv?this._key:void 0},d.prototype.getKey=d.prototype.getPrivateKey,d.prototype._keyCheck=function(t,r){if(e.object(t,\"key\"),r||a.assertCompatible(t,n,[1,3],\"key\"),a.assertCompatible(t,h,[1,4],\"key\"),t.type!==this._algo)throw new Error(\"A \"+t.type+\" key cannot be used in \"+this._algo+\" Diffie-Hellman\");if(t.curve!==this._curve)throw new Error(\"A key from the \"+t.curve+\" curve cannot be used with a \"+this._curve+\" Diffie-Hellman\");\"dsa\"===t.type&&(e.deepEqual(t.part.p,this._p,\"DSA key prime does not match\"),e.deepEqual(t.part.g,this._g,\"DSA key generator does not match\"))},d.prototype.setKey=function(e){if(this._keyCheck(e),\"dsa\"===e.type)this._dh.setPrivateKey(e.part.x.data),this._dh.setPublicKey(e.part.y.data);else if(\"ecdsa\"===e.type)p?(this._dh.setPrivateKey(e.part.d.data),this._dh.setPublicKey(e.part.Q.data)):this._priv=new _(this._ecParams,e.part.d.data);else if(\"curve25519\"===e.type){var t=e.part.k;e.part.k||(t=e.part.r),this._priv=t.data,0===this._priv[0]&&(this._priv=this._priv.slice(1)),this._priv=this._priv.slice(0,32)}this._key=e,this._isPriv=!0},d.prototype.setPrivateKey=d.prototype.setKey,d.prototype.computeSecret=function(t){if(this._keyCheck(t,!0),!this._isPriv)throw new Error(\"DH exchange has not been initialized with a private key yet\");var i;if(\"dsa\"===this._algo)return this._dh.computeSecret(t.part.y.data);if(\"ecdsa\"===this._algo)return p?this._dh.computeSecret(t.part.Q.data):(i=new v(this._ecParams,t.part.Q.data),this._priv.deriveSharedSecret(i));if(\"curve25519\"===this._algo){for(i=t.part.A.data;0===i[0]&&i.length>32;)i=i.slice(1);var a=this._priv;e.strictEqual(i.length,32),e.strictEqual(a.length,32);var h=s.box.before(new Uint8Array(i),new Uint8Array(a));return r.from(h)}throw new Error(\"Invalid algorithm: \"+this._algo)},d.prototype.generateKey=function(){var i,a,h=[];if(\"dsa\"===this._algo)return this._dh.generateKeys(),h.push({name:\"p\",data:this._p.data}),h.push({name:\"q\",data:this._key.part.q.data}),h.push({name:\"g\",data:this._g.data}),h.push({name:\"y\",data:this._dh.getPublicKey()}),h.push({name:\"x\",data:this._dh.getPrivateKey()}),this._key=new n({type:\"dsa\",parts:h}),this._isPriv=!0,this._key;if(\"ecdsa\"===this._algo){if(p)return this._dh.generateKeys(),h.push({name:\"curve\",data:r.from(this._curve)}),h.push({name:\"Q\",data:this._dh.getPublicKey()}),h.push({name:\"d\",data:this._dh.getPrivateKey()}),this._key=new n({type:\"ecdsa\",curve:this._curve,parts:h}),this._isPriv=!0,this._key;var o=this._ecParams.getN(),u=new c(t.randomBytes(o.bitLength())),d=o.subtract(c.ONE);return i=u.mod(d).add(c.ONE),a=this._ecParams.getG().multiply(i),i=r.from(i.toByteArray()),a=r.from(this._ecParams.getCurve().encodePointHex(a),\"hex\"),this._priv=new _(this._ecParams,i),h.push({name:\"curve\",data:r.from(this._curve)}),h.push({name:\"Q\",data:a}),h.push({name:\"d\",data:i}),this._key=new n({type:\"ecdsa\",curve:this._curve,parts:h}),this._isPriv=!0,this._key}if(\"curve25519\"===this._algo){var y=s.box.keyPair();return i=r.from(y.secretKey),a=r.from(y.publicKey),i=r.concat([i,a]),e.strictEqual(i.length,64),e.strictEqual(a.length,32),h.push({name:\"A\",data:a}),h.push({name:\"k\",data:i}),this._key=new n({type:\"curve25519\",parts:h}),this._isPriv=!0,this._key}throw new Error(\"Invalid algorithm: \"+this._algo)},d.prototype.generateKeys=d.prototype.generateKey,y.prototype.getCurve=function(){return this.curve},y.prototype.getG=function(){return this.g},y.prototype.getN=function(){return this.n},y.prototype.getH=function(){return this.h},_.prototype.deriveSharedSecret=function(t){e.ok(t instanceof v);var i=t._pub.multiply(this._priv);return r.from(i.getX().toBigInteger().toByteArray())};"},"sourceMaps":null,"error":null,"hash":"e39b0043d59a4bbb6b1042c2fe037cfd","cacheData":{"env":{}}}