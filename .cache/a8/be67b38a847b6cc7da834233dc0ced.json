{"id":"mpxe","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585391671622},{"name":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/package.json","includedInParent":true,"mtime":1585257763166},{"name":"assert-plus","loc":{"line":5,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/assert-plus/assert.js"},{"name":"safer-buffer","loc":{"line":6,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/safer-buffer/safer.js"},{"name":"./algs","loc":{"line":7,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/algs.js"},{"name":"crypto","loc":{"line":8,"column":21},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js","resolved":"/Users/m/.config/yarn/global/node_modules/crypto-browserify/index.js"},{"name":"./errors","loc":{"line":9,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/errors.js"},{"name":"./utils","loc":{"line":10,"column":20},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/utils.js"},{"name":"asn1","loc":{"line":11,"column":19},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/asn1/lib/index.js"},{"name":"./ssh-buffer","loc":{"line":12,"column":24},"parent":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/signature.js","resolved":"/Users/m/www/oio/land/oio.radio/node_modules/sshpk/lib/ssh-buffer.js"}],"generated":{"js":"\nmodule.exports=f;var r=require(\"assert-plus\"),t=require(\"safer-buffer\").Buffer,e=require(\"./algs\"),a=require(\"crypto\"),s=require(\"./errors\"),i=require(\"./utils\"),n=require(\"asn1\"),h=require(\"./ssh-buffer\"),o=s.InvalidAlgorithmError,u=s.SignatureParseError;function f(t){r.object(t,\"options\"),r.arrayOfObject(t.parts,\"options.parts\"),r.string(t.type,\"options.type\");for(var e={},a=0;a<t.parts.length;++a){var s=t.parts[a];e[s.name]=s}this.type=t.type,this.hashAlgorithm=t.hashAlgo,this.curve=t.curve,this.parts=t.parts,this.part=e}function p(t,e,a,s){if(\"ssh\"===a){try{var i=new h({buffer:t}),n=i.readString()}catch(p){}if(void 0!==i){var o=\"SSH signature does not match expected type (expected \"+e+\", got \"+n+\")\";switch(n){case\"ssh-rsa\":r.strictEqual(e,\"rsa\",o),s.hashAlgo=\"sha1\";break;case\"rsa-sha2-256\":r.strictEqual(e,\"rsa\",o),s.hashAlgo=\"sha256\";break;case\"rsa-sha2-512\":r.strictEqual(e,\"rsa\",o),s.hashAlgo=\"sha512\";break;case\"ssh-ed25519\":r.strictEqual(e,\"ed25519\",o),s.hashAlgo=\"sha512\";break;default:throw new Error(\"Unknown SSH signature type: \"+n)}var u=i.readPart();return r.ok(i.atEnd(),\"extra trailing bytes\"),u.name=\"sig\",s.parts.push(u),new f(s)}}return s.parts.push({name:\"sig\",data:t}),new f(s)}function c(r,t,e,a){var s=new n.BerReader(r);s.readSequence();var h=s.readString(n.Ber.Integer,!0),o=s.readString(n.Ber.Integer,!0);return a.parts.push({name:\"r\",data:i.mpNormalize(h)}),a.parts.push({name:\"s\",data:i.mpNormalize(o)}),new f(a)}function g(t,e,a,s){if(40!=t.length){var i=new h({buffer:t}),n=i.readBuffer();\"ssh-dss\"===n.toString(\"ascii\")&&(n=i.readBuffer()),r.ok(i.atEnd(),\"extra trailing bytes\"),r.strictEqual(n.length,40,\"invalid inner length\"),t=n}return s.parts.push({name:\"r\",data:t.slice(0,20)}),s.parts.push({name:\"s\",data:t.slice(20,40)}),new f(s)}function d(t,e,a,s){var i,n,o=new h({buffer:t}),u=o.readBuffer(),p=u.toString(\"ascii\");if(\"ecdsa-\"===p.slice(0,6)){var c=p.split(\"-\");switch(r.strictEqual(c[0],\"ecdsa\"),r.strictEqual(c[1],\"sha2\"),s.curve=c[2],s.curve){case\"nistp256\":s.hashAlgo=\"sha256\";break;case\"nistp384\":s.hashAlgo=\"sha384\";break;case\"nistp521\":s.hashAlgo=\"sha512\";break;default:throw new Error(\"Unsupported ECDSA curve: \"+s.curve)}u=o.readBuffer(),r.ok(o.atEnd(),\"extra trailing bytes on outer\"),i=(o=new h({buffer:u})).readPart()}else i={data:u};return n=o.readPart(),r.ok(o.atEnd(),\"extra trailing bytes\"),i.name=\"r\",n.name=\"s\",s.parts.push(i),s.parts.push(n),new f(s)}f.prototype.toBuffer=function(e){var a;void 0===e&&(e=\"asn1\"),r.string(e,\"format\");var s=\"ssh-\"+this.type;switch(this.type){case\"rsa\":switch(this.hashAlgorithm){case\"sha256\":s=\"rsa-sha2-256\";break;case\"sha512\":s=\"rsa-sha2-512\";break;case\"sha1\":case void 0:break;default:throw new Error(\"SSH signature format does not support hash algorithm \"+this.hashAlgorithm)}return\"ssh\"===e?((a=new h({})).writeString(s),a.writePart(this.part.sig),a.toBuffer()):this.part.sig.data;case\"ed25519\":return\"ssh\"===e?((a=new h({})).writeString(s),a.writePart(this.part.sig),a.toBuffer()):this.part.sig.data;case\"dsa\":case\"ecdsa\":var o,u;if(\"asn1\"===e){var f=new n.BerWriter;return f.startSequence(),o=i.mpNormalize(this.part.r.data),u=i.mpNormalize(this.part.s.data),f.writeBuffer(o,n.Ber.Integer),f.writeBuffer(u,n.Ber.Integer),f.endSequence(),f.buffer}if(\"ssh\"===e&&\"dsa\"===this.type){if((a=new h({})).writeString(\"ssh-dss\"),(o=this.part.r.data).length>20&&0===o[0]&&(o=o.slice(1)),(u=this.part.s.data).length>20&&0===u[0]&&(u=u.slice(1)),this.hashAlgorithm&&\"sha1\"!==this.hashAlgorithm||o.length+u.length!==40)throw new Error(\"OpenSSH only supports DSA signatures with SHA1 hash\");return a.writeBuffer(t.concat([o,u])),a.toBuffer()}if(\"ssh\"===e&&\"ecdsa\"===this.type){var p,c=new h({});o=this.part.r.data,c.writeBuffer(o),c.writePart(this.part.s),a=new h({}),0===o[0]&&(o=o.slice(1));var g=8*o.length;return 256===g?p=\"nistp256\":384===g?p=\"nistp384\":528===g&&(p=\"nistp521\"),a.writeString(\"ecdsa-sha2-\"+p),a.writeBuffer(c.toBuffer()),a.toBuffer()}throw new Error(\"Invalid signature format\");default:throw new Error(\"Invalid signature data\")}},f.prototype.toString=function(t){return r.optionalString(t,\"format\"),this.toBuffer(t).toString(\"base64\")},f.parse=function(e,a,s){\"string\"==typeof e&&(e=t.from(e,\"base64\")),r.buffer(e,\"data\"),r.string(s,\"format\"),r.string(a,\"type\");var i={};i.type=a.toLowerCase(),i.parts=[];try{switch(r.ok(e.length>0,\"signature must not be empty\"),i.type){case\"rsa\":case\"ed25519\":return p(e,a,s,i);case\"dsa\":case\"ecdsa\":return\"asn1\"===s?c(e,a,s,i):\"dsa\"===i.type?g(e,a,s,i):d(e,a,s,i);default:throw new o(a)}}catch(n){if(n instanceof o)throw n;throw new u(a,s,n)}},f.isSignature=function(r,t){return i.isCompatible(r,f,t)},f.prototype._sshpkApiVersion=[2,1],f._oldVersionDetect=function(t){return r.func(t.toBuffer),t.hasOwnProperty(\"hashAlgorithm\")?[2,0]:[1,0]};"},"sourceMaps":null,"error":null,"hash":"23c4338f59a75d0d3cb48b6571488fec","cacheData":{"env":{}}}