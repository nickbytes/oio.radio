{"id":"C2m1","dependencies":[{"name":"/Users/m/www/oio/land/oio.radio/package.json","includedInParent":true,"mtime":1585257763511},{"name":"/Users/m/.config/yarn/global/node_modules/elliptic/package.json","includedInParent":true,"mtime":1578331559845},{"name":"bn.js","loc":{"line":3,"column":17},"parent":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/Users/m/.config/yarn/global/node_modules/bn.js/lib/bn.js"},{"name":"hmac-drbg","loc":{"line":4,"column":23},"parent":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/Users/m/.config/yarn/global/node_modules/hmac-drbg/lib/hmac-drbg.js"},{"name":"../utils","loc":{"line":5,"column":20},"parent":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/utils.js"},{"name":"../curves","loc":{"line":6,"column":21},"parent":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/curves.js"},{"name":"brorand","loc":{"line":7,"column":19},"parent":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/Users/m/.config/yarn/global/node_modules/brorand/index.js"},{"name":"./key","loc":{"line":10,"column":22},"parent":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/key.js"},{"name":"./signature","loc":{"line":11,"column":24},"parent":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/Users/m/.config/yarn/global/node_modules/elliptic/lib/elliptic/ec/signature.js"}],"generated":{"js":"\"use strict\";var r=require(\"bn.js\"),e=require(\"hmac-drbg\"),t=require(\"../utils\"),n=require(\"../curves\"),i=require(\"brorand\"),s=t.assert,o=require(\"./key\"),u=require(\"./signature\");function h(r){if(!(this instanceof h))return new h(r);\"string\"==typeof r&&(s(n.hasOwnProperty(r),\"Unknown curve \"+r),r=n[r]),r instanceof n.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}module.exports=h,h.prototype.keyPair=function(r){return new o(this,r)},h.prototype.keyFromPrivate=function(r,e){return o.fromPrivate(this,r,e)},h.prototype.keyFromPublic=function(r,e){return o.fromPublic(this,r,e)},h.prototype.genKeyPair=function(t){t||(t={});for(var n=new e({hash:this.hash,pers:t.pers,persEnc:t.persEnc||\"utf8\",entropy:t.entropy||i(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||\"utf8\",nonce:this.n.toArray()}),s=this.n.byteLength(),o=this.n.sub(new r(2));;){var u=new r(n.generate(s));if(!(u.cmp(o)>0))return u.iaddn(1),this.keyFromPrivate(u)}},h.prototype._truncateToN=function(r,e){var t=8*r.byteLength()-this.n.bitLength();return t>0&&(r=r.ushrn(t)),!e&&r.cmp(this.n)>=0?r.sub(this.n):r},h.prototype.sign=function(t,n,i,s){\"object\"==typeof i&&(s=i,i=null),s||(s={}),n=this.keyFromPrivate(n,i),t=this._truncateToN(new r(t,16));for(var o=this.n.byteLength(),h=n.getPrivate().toArray(\"be\",o),c=t.toArray(\"be\",o),a=new e({hash:this.hash,entropy:h,nonce:c,pers:s.pers,persEnc:s.persEnc||\"utf8\"}),p=this.n.sub(new r(1)),m=0;;m++){var v=s.k?s.k(m):new r(a.generate(this.n.byteLength()));if(!((v=this._truncateToN(v,!0)).cmpn(1)<=0||v.cmp(p)>=0)){var y=this.g.mul(v);if(!y.isInfinity()){var f=y.getX(),g=f.umod(this.n);if(0!==g.cmpn(0)){var d=v.invm(this.n).mul(g.mul(n.getPrivate()).iadd(t));if(0!==(d=d.umod(this.n)).cmpn(0)){var b=(y.getY().isOdd()?1:0)|(0!==f.cmp(g)?2:0);return s.canonical&&d.cmp(this.nh)>0&&(d=this.n.sub(d),b^=1),new u({r:g,s:d,recoveryParam:b})}}}}}},h.prototype.verify=function(e,t,n,i){e=this._truncateToN(new r(e,16)),n=this.keyFromPublic(n,i);var s=(t=new u(t,\"hex\")).r,o=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var h,c=o.invm(this.n),a=c.mul(e).umod(this.n),p=c.mul(s).umod(this.n);return this.curve._maxwellTrick?!(h=this.g.jmulAdd(a,n.getPublic(),p)).isInfinity()&&h.eqXToP(s):!(h=this.g.mulAdd(a,n.getPublic(),p)).isInfinity()&&0===h.getX().umod(this.n).cmp(s)},h.prototype.recoverPubKey=function(e,t,n,i){s((3&n)===n,\"The recovery param is more than two bits\"),t=new u(t,i);var o=this.n,h=new r(e),c=t.r,a=t.s,p=1&n,m=n>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&m)throw new Error(\"Unable to find sencond key candinate\");c=m?this.curve.pointFromX(c.add(this.curve.n),p):this.curve.pointFromX(c,p);var v=t.r.invm(o),y=o.sub(h).mul(v).umod(o),f=a.mul(v).umod(o);return this.g.mulAdd(y,c,f)},h.prototype.getKeyRecoveryParam=function(r,e,t,n){if(null!==(e=new u(e,n)).recoveryParam)return e.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(r,e,i)}catch(r){continue}if(s.eq(t))return i}throw new Error(\"Unable to find valid recovery factor\")};"},"sourceMaps":null,"error":null,"hash":"35cfad59244efcb9e22f8c4cfb5435ec","cacheData":{"env":{}}}